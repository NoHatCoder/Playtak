(function(){function a(f){this.object=f;this.target=new THREE.Vector3();this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=false;this.dampingFactor=0.25;var j=this;var h=0.000001;var c;var i;var d=0;var k=0;var e=1;var g=new THREE.Vector3();var b=false;this.getPolarAngle=function(){return i};this.getAzimuthalAngle=function(){return c};this.rotateLeft=function(l){k-=l};this.rotateUp=function(l){d-=l};this.panLeft=function(){var l=new THREE.Vector3();return function m(o){var n=this.object.matrix.elements;l.set(n[0],n[1],n[2]);l.multiplyScalar(-o);g.add(l)}}();this.panUp=function(){var l=new THREE.Vector3();return function m(o){var n=this.object.matrix.elements;l.set(n[4],n[5],n[6]);l.multiplyScalar(o);g.add(l)}}();this.pan=function(n,m,p,r){if(j.object instanceof THREE.PerspectiveCamera){var l=j.object.position;var q=l.clone().sub(j.target);var o=q.length();o*=Math.tan((j.object.fov/2)*Math.PI/180);j.panLeft(2*n*o/r);j.panUp(2*m*o/r)}else{if(j.object instanceof THREE.OrthographicCamera){j.panLeft(n*(j.object.right-j.object.left)/p);j.panUp(m*(j.object.top-j.object.bottom)/r)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")}}};this.dollyIn=function(l){if(j.object instanceof THREE.PerspectiveCamera){e/=l}else{if(j.object instanceof THREE.OrthographicCamera){j.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*l));j.object.updateProjectionMatrix();b=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")}}};this.dollyOut=function(l){if(j.object instanceof THREE.PerspectiveCamera){e*=l}else{if(j.object instanceof THREE.OrthographicCamera){j.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/l));j.object.updateProjectionMatrix();b=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")}}};this.update=function(){var p=new THREE.Vector3();var n=new THREE.Quaternion().setFromUnitVectors(f.up,new THREE.Vector3(0,1,0));var o=n.clone().inverse();var m=new THREE.Vector3();var l=new THREE.Quaternion();return function(){var r=this.object.position;p.copy(r).sub(this.target);p.applyQuaternion(n);c=Math.atan2(p.x,p.z);i=Math.atan2(Math.sqrt(p.x*p.x+p.z*p.z),p.y);c+=k;i+=d;c=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,c));i=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,i));i=Math.max(h,Math.min(Math.PI-h,i));var q=p.length()*e;q=Math.max(this.minDistance,Math.min(this.maxDistance,q));this.target.add(g);p.x=q*Math.sin(i)*Math.sin(c);p.y=q*Math.cos(i);p.z=q*Math.sin(i)*Math.cos(c);p.applyQuaternion(o);r.copy(this.target).add(p);this.object.lookAt(this.target);if(this.enableDamping===true){k*=(1-this.dampingFactor);d*=(1-this.dampingFactor)}else{k=0;d=0}e=1;g.set(0,0,0);if(b||m.distanceToSquared(this.object.position)>h||8*(1-l.dot(this.object.quaternion))>h){m.copy(this.object.position);l.copy(this.object.quaternion);b=false;return true}return false}}()}THREE.OrbitControls=function(E,D){var b=new a(E);this.domElement=(D!==undefined)?D:document;Object.defineProperty(this,"constraint",{get:function(){return b}});this.getPolarAngle=function(){return b.getPolarAngle()};this.getAzimuthalAngle=function(){return b.getAzimuthalAngle()};this.enabled=true;this.center=this.target;this.enableZoom=true;this.zoomSpeed=1;this.enableRotate=true;this.rotateSpeed=1;this.enablePan=true;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.enableKeys=true;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var c=this;var A=new THREE.Vector2();var h=new THREE.Vector2();var o=new THREE.Vector2();var e=new THREE.Vector2();var l=new THREE.Vector2();var z=new THREE.Vector2();var d=new THREE.Vector2();var s=new THREE.Vector2();var x=new THREE.Vector2();var w={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var i=w.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;var C={type:"change"};var t={type:"start"};var q={type:"end"};function r(G,F){var H=c.domElement===document?c.domElement.body:c.domElement;b.pan(G,F,H.clientWidth,H.clientHeight)}this.update=function(){if(this.autoRotate&&i===w.NONE){b.rotateLeft(j())}if(b.update()===true){this.dispatchEvent(C)}};this.reset=function(){i=w.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.object.zoom=this.zoom0;this.object.updateProjectionMatrix();this.dispatchEvent(C);this.update()};function j(){return 2*Math.PI/60/60*c.autoRotateSpeed}function v(){return Math.pow(0.95,c.zoomSpeed)}function k(F){if(c.enabled===false){return}F.preventDefault();if(F.button===c.mouseButtons.ORBIT){if(c.enableRotate===false){return}i=w.ROTATE;A.set(F.clientX,F.clientY)}else{if(F.button===c.mouseButtons.ZOOM){if(c.enableZoom===false){return}i=w.DOLLY;d.set(F.clientX,F.clientY)}else{if(F.button===c.mouseButtons.PAN){if(c.enablePan===false){return}i=w.PAN;e.set(F.clientX,F.clientY)}}}if(i!==w.NONE){document.addEventListener("mousemove",n,false);document.addEventListener("mouseup",g,false);c.dispatchEvent(t)}}function n(G){if(c.enabled===false){return}G.preventDefault();var F=c.domElement===document?c.domElement.body:c.domElement;if(i===w.ROTATE){if(c.enableRotate===false){return}h.set(G.clientX,G.clientY);o.subVectors(h,A);b.rotateLeft(2*Math.PI*o.x/F.clientWidth*c.rotateSpeed);b.rotateUp(2*Math.PI*o.y/F.clientHeight*c.rotateSpeed);A.copy(h)}else{if(i===w.DOLLY){if(c.enableZoom===false){return}s.set(G.clientX,G.clientY);x.subVectors(s,d);if(x.y>0){b.dollyIn(v())}else{if(x.y<0){b.dollyOut(v())}}d.copy(s)}else{if(i===w.PAN){if(c.enablePan===false){return}l.set(G.clientX,G.clientY);z.subVectors(l,e);r(z.x,z.y);e.copy(l)}}}if(i!==w.NONE){c.update()}}function g(){if(c.enabled===false){return}document.removeEventListener("mousemove",n,false);document.removeEventListener("mouseup",g,false);c.dispatchEvent(q);i=w.NONE}function m(F){if(c.enabled===false||c.enableZoom===false||i!==w.NONE){return}F.preventDefault();F.stopPropagation();var G=0;if(F.wheelDelta!==undefined){G=F.wheelDelta}else{if(F.detail!==undefined){G=-F.detail}}if(G>0){b.dollyOut(v())}else{if(G<0){b.dollyIn(v())}}c.update();c.dispatchEvent(t);c.dispatchEvent(q)}function f(F){if(c.enabled===false||c.enableKeys===false||c.enablePan===false){return}switch(F.keyCode){case c.keys.UP:r(0,c.keyPanSpeed);c.update();break;case c.keys.BOTTOM:r(0,-c.keyPanSpeed);c.update();break;case c.keys.LEFT:r(c.keyPanSpeed,0);c.update();break;case c.keys.RIGHT:r(-c.keyPanSpeed,0);c.update();break}}function y(H){if(c.enabled===false){return}switch(H.touches.length){case 1:if(c.enableRotate===false){return}i=w.TOUCH_ROTATE;A.set(H.touches[0].pageX,H.touches[0].pageY);break;case 2:if(c.enableZoom===false){return}i=w.TOUCH_DOLLY;var G=H.touches[0].pageX-H.touches[1].pageX;var F=H.touches[0].pageY-H.touches[1].pageY;var I=Math.sqrt(G*G+F*F);d.set(0,I);break;case 3:if(c.enablePan===false){return}i=w.TOUCH_PAN;e.set(H.touches[0].pageX,H.touches[0].pageY);break;default:i=w.NONE}if(i!==w.NONE){c.dispatchEvent(t)}}function p(I){if(c.enabled===false){return}I.preventDefault();I.stopPropagation();var H=c.domElement===document?c.domElement.body:c.domElement;switch(I.touches.length){case 1:if(c.enableRotate===false){return}if(i!==w.TOUCH_ROTATE){return}h.set(I.touches[0].pageX,I.touches[0].pageY);o.subVectors(h,A);b.rotateLeft(2*Math.PI*o.x/H.clientWidth*c.rotateSpeed);b.rotateUp(2*Math.PI*o.y/H.clientHeight*c.rotateSpeed);A.copy(h);c.update();break;case 2:if(c.enableZoom===false){return}if(i!==w.TOUCH_DOLLY){return}var G=I.touches[0].pageX-I.touches[1].pageX;var F=I.touches[0].pageY-I.touches[1].pageY;var J=Math.sqrt(G*G+F*F);s.set(0,J);x.subVectors(s,d);if(x.y>0){b.dollyOut(v())}else{if(x.y<0){b.dollyIn(v())}}d.copy(s);c.update();break;case 3:if(c.enablePan===false){return}if(i!==w.TOUCH_PAN){return}l.set(I.touches[0].pageX,I.touches[0].pageY);z.subVectors(l,e);r(z.x,z.y);e.copy(l);c.update();break;default:i=w.NONE}}function B(){if(c.enabled===false){return}c.dispatchEvent(q);i=w.NONE}function u(F){F.preventDefault()}this.dispose=function(){this.domElement.removeEventListener("contextmenu",u,false);this.domElement.removeEventListener("mousedown",k,false);this.domElement.removeEventListener("mousewheel",m,false);this.domElement.removeEventListener("DOMMouseScroll",m,false);this.domElement.removeEventListener("touchstart",y,false);this.domElement.removeEventListener("touchend",B,false);this.domElement.removeEventListener("touchmove",p,false);document.removeEventListener("mousemove",n,false);document.removeEventListener("mouseup",g,false);window.removeEventListener("keydown",f,false)};this.domElement.addEventListener("contextmenu",u,false);this.domElement.addEventListener("mousedown",k,false);this.domElement.addEventListener("mousewheel",m,false);this.domElement.addEventListener("DOMMouseScroll",m,false);this.domElement.addEventListener("touchstart",y,false);this.domElement.addEventListener("touchend",B,false);this.domElement.addEventListener("touchmove",p,false);window.addEventListener("keydown",f,false);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{object:{get:function(){return this.constraint.object}},target:{get:function(){return this.constraint.target},set:function(b){console.warn("THREE.OrbitControls: target is now immutable. Use target.set() instead.");this.constraint.target.copy(b)}},minDistance:{get:function(){return this.constraint.minDistance},set:function(b){this.constraint.minDistance=b}},maxDistance:{get:function(){return this.constraint.maxDistance},set:function(b){this.constraint.maxDistance=b}},minZoom:{get:function(){return this.constraint.minZoom},set:function(b){this.constraint.minZoom=b}},maxZoom:{get:function(){return this.constraint.maxZoom},set:function(b){this.constraint.maxZoom=b}},minPolarAngle:{get:function(){return this.constraint.minPolarAngle},set:function(b){this.constraint.minPolarAngle=b}},maxPolarAngle:{get:function(){return this.constraint.maxPolarAngle},set:function(b){this.constraint.maxPolarAngle=b}},minAzimuthAngle:{get:function(){return this.constraint.minAzimuthAngle},set:function(b){this.constraint.minAzimuthAngle=b}},maxAzimuthAngle:{get:function(){return this.constraint.maxAzimuthAngle},set:function(b){this.constraint.maxAzimuthAngle=b}},enableDamping:{get:function(){return this.constraint.enableDamping},set:function(b){this.constraint.enableDamping=b}},dampingFactor:{get:function(){return this.constraint.dampingFactor},set:function(b){this.constraint.dampingFactor=b}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return !this.enableZoom},set:function(b){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!b}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return !this.enableRotate},set:function(b){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!b}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return !this.enablePan},set:function(b){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!b}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");return !this.enableKeys},set:function(b){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!b}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return !this.constraint.enableDamping},set:function(b){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.constraint.enableDamping=!b}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");return this.constraint.dampingFactor},set:function(b){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.constraint.dampingFactor=b}}})}());